<!DOCTYPE HTML><html lang="zh-CN"><head><link rel="manifest" href="/manifest.json"><meta charset="utf-8"><meta name="keywords" content="åŸºäºSTM32è¶…å£°æ³¢é¿éšœå°è½¦, åµŒå…¥å¼è½¯ä»¶ ARM C/C++"><meta name="description" content="æ‰‹æŠŠæ‰‹æ•™ä½ åšSTM32é¿éšœå°è½¦"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="theme-color" content="white"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>åŸºäºSTM32è¶…å£°æ³¢é¿éšœå°è½¦ | å°å¸ˆå¼Ÿ</title><link rel="icon" type="image/png" href="/favicon.png"><link rel="apple-touch-icon" href="/medias/apple-touch-icon.png"><link rel="stylesheet" href="/libs/awesome/css/all.css"><link rel="stylesheet" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" href="/libs/aos/aos.css"><link rel="stylesheet" href="/libs/animate/animate.min.css"><link rel="stylesheet" href="/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" href="/css/matery.css"><link rel="stylesheet" href="/css/my.css"><script src="/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.1.1"><link rel="stylesheet" href="/css/prism-tomorrow.css"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper head-container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">å°å¸ˆå¼Ÿ</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>ä¸»é¡µ</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-sitemap" style="zoom:.6"></i> <span>ç»Ÿè®¡</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/categories"><i class="fas fa-bookmark" style="margin-top:-20px;zoom:.6"></i> <span>åˆ†ç±»</span></a></li><li><a href="/tags"><i class="fas fa-tags" style="margin-top:-20px;zoom:.6"></i> <span>æ ‡ç­¾</span></a></li><li><a href="/archives"><i class="fas fa-archive" style="margin-top:-20px;zoom:.6"></i> <span>å½’æ¡£</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fas fa-list" style="zoom:.6"></i> <span>åª’ä½“</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/movies"><i class="fas fa-film" style="margin-top:-20px;zoom:.6"></i> <span>ç”µå½±</span></a></li><li><a href="/books"><i class="fas fa-book" style="margin-top:-20px;zoom:.6"></i> <span>ä¹¦å•</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-addres-card" style="zoom:.6"></i> <span>å…³äº</span><i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/about"><i class="fas fa-user-circle" style="margin-top:-20px;zoom:.6"></i> <span>å…³äºæˆ‘</span></a></li><li><a href="/aboutme"><i class="fas fa-user-secret" style="margin-top:-20px;zoom:.6"></i> <span>ä¸ªäººç®€ä»‹</span></a></li></ul></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-share-alt" style="zoom:.6"></i> <span>å‹æƒ…é“¾æ¥</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/box" class="waves-effect waves-light"><i class="fas fa-briefcase" style="zoom:.6"></i> <span>ç½‘å€å¯¼èˆª</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/2019-nCov" class="waves-effect waves-light"><i class="fas fa-heartbeat" style="zoom:.6"></i> <span>å®æ—¶ç–«æƒ…</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="æœç´¢" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">å°å¸ˆå¼Ÿ</div><div class="logo-desc">ä¸€ä¸ªå–œæ¬¢åµŒå…¥å¼çš„å°ç å†œ</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> ä¸»é¡µ</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-sitemap"></i> ç»Ÿè®¡<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/categories" style="margin-left:75px" ;><i class="fa fas fa-bookmark" style="position:absolute;left:50px"></i> <span>åˆ†ç±»</span></a></li><li><a href="/tags" style="margin-left:75px" ;><i class="fa fas fa-tags" style="position:absolute;left:50px"></i> <span>æ ‡ç­¾</span></a></li><li><a href="/archives" style="margin-left:75px" ;><i class="fa fas fa-archive" style="position:absolute;left:50px"></i> <span>å½’æ¡£</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-list"></i> åª’ä½“<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/movies" style="margin-left:75px" ;><i class="fa fas fa-film" style="position:absolute;left:50px"></i> <span>ç”µå½±</span></a></li><li><a href="/books" style="margin-left:75px" ;><i class="fa fas fa-book" style="position:absolute;left:50px"></i> <span>ä¹¦å•</span></a></li></ul></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-addres-card"></i> å…³äº<span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/about" style="margin-left:75px" ;><i class="fa fas fa-user-circle" style="position:absolute;left:50px"></i> <span>å…³äºæˆ‘</span></a></li><li><a href="/aboutme" style="margin-left:75px" ;><i class="fa fas fa-user-secret" style="position:absolute;left:50px"></i> <span>ä¸ªäººç®€ä»‹</span></a></li></ul></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-share-alt"></i> å‹æƒ…é“¾æ¥</a></li><li class="m-nav-item"><a href="/box" class="waves-effect waves-light"><i class="fa-fw fas fa-briefcase"></i> ç½‘å€å¯¼èˆª</a></li><li class="m-nav-item"><a href="/2019-nCov" class="waves-effect waves-light"><i class="fa-fw fas fa-heartbeat"></i> å®æ—¶ç–«æƒ…</a></li><li><div class="divider"></div></li><li><a href="https://github.com/xiaoshidi-hub" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i> Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#f062a7;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/xiaoshidi-hub" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/cover1.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">åŸºäºSTM32è¶…å£°æ³¢é¿éšœå°è½¦</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px}#toc-content .is-active-link{color:#42b983}#toc-content .is-active-link::before{background-color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/STM32/"><span class="chip bg-color">STM32</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/STM32/" class="post-category">STM32</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i> å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp; 2020-01-15</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i> æ›´æ–°æ—¥æœŸ:&nbsp;&nbsp; 2020-01-15</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i> æ–‡ç« å­—æ•°:&nbsp;&nbsp; 3.6k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i> é˜…è¯»æ—¶é•¿:&nbsp;&nbsp; 14 åˆ†</div><div id="busuanzi_container_page_pv" class="info-break-policy"><i class="far fa-eye fa-fw"></i> é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;<span id="busuanzi_value_page_pv"></span></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><blockquote><p>å¾®ä¿¡å…¬ä¼—å·ï¼š<strong><a href="#jump_10">æœæœå°å¸ˆå¼Ÿ</a></strong><br>å…³æ³¨å¯äº†è§£è·å–æ›´å¤šèµ„æ–™æ•™ç¨‹ã€‚é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·å…¬ä¼—å·ç•™è¨€;<br><strong><a href="#jump_20">å¦‚æœä½ è§‰å¾—æ­¤ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç•™è¨€å…³æ³¨</a></strong></p></blockquote><p>ä¸ç®¡æ˜¯å¯¹äºåˆå­¦è€…è¿˜æ˜¯å¯¹äºä¸€ä¸ªç©è¿‡å•ç‰‡æœºçš„ç”µå­çˆ±å¥½è€…æ¥è¯´ï¼Œæˆ–å¤šæˆ–å°‘éƒ½æ¥è§¦åˆ°è¿‡å°è½¦é¡¹ç›®ï¼Œä»Šå¤©ç»™å¤§å®¶ä»‹ç»çš„çš„ä¸€ä¸ªé¡¹ç›®åŸºäºSTM32è¶…å£°æ³¢é¿éšœå°è½¦ã€‚è¿™ä¹Ÿæ˜¯æˆ‘æ›¾ç»çš„ä¸€ä¸ªè¯¾è®¾ï¼Œåœ¨æ­¤å¼€æºåˆ†äº«ç»™å¤§å®¶ï¼Œå…¨æ–‡5000å¤šå­—ï¼Œå¹²è´§æ»¡æ»¡ï¼ŒåŠ æ²¹è¯»å®Œï¼Œä¿è¯ä½ æ”¶è´§å¤šå¤šã€‚</p><h2 id="å¤„ç†å™¨ç”µè·¯è®¾è®¡"><a href="#å¤„ç†å™¨ç”µè·¯è®¾è®¡" class="headerlink" title="å¤„ç†å™¨ç”µè·¯è®¾è®¡"></a><center>å¤„ç†å™¨ç”µè·¯è®¾è®¡</center></h2><p>å•ç‰‡æœºæ˜¯ç³»ç»Ÿçš„CPUï¼Œæ˜¯ç³»ç»Ÿç¨³å®šã€æ­£å¸¸è¿è¡Œçš„é‡è¦å‰æï¼Œä»¥ä¸‹ä¸ºå•ç‰‡æœºé€‰å‹çš„ä¸¤ç§æ–¹æ¡ˆï¼š<br>ï¼ˆ1ï¼‰ä¼ ç»Ÿçš„8ä½å•ç‰‡æœºï¼Œæ˜¯é€šè¿‡è¶…å¤§è§„æ¨¡é›†æˆç”µè·¯å¯¹å…¶è¿›è¡Œé›†æˆä¸ºä¸€ä¸ªç‹¬ç«‹èŠ¯ç‰‡çš„æ§åˆ¶å™¨ã€‚å†…éƒ¨ç»„ä»¶åŒ…æ‹¬CPUã€éšæœºå­˜å‚¨å™¨ã€åªè¯»å­˜å‚¨å™¨ã€I/Oæ¥å£ã€ä¸­æ–­ç³»ç»Ÿã€è®¡æ—¶å™¨ã€ä¸²å£é€šè®¯ã€æ•°æ¨¡è½¬æ¢ç­‰ã€‚STC89C52å•ç‰‡æœºæ˜¯æœ€å¸¸è§çš„51å•ç‰‡æœºï¼Œä½†æ˜¯èµ„æºè¾ƒå°‘ï¼Œç²¾ç¡®åº¦ä½ï¼Œå¤„ç†é€Ÿåº¦ç›¸æ¯”STM32å•ç‰‡æœºå·®å¾ˆå¤šã€‚<br>ï¼ˆ2ï¼‰ä½¿ç”¨ç›®å‰å¸‚é¢ä¸Šæœ€å¸¸è§çš„STM32å•ç‰‡æœºï¼ŒSTM32ç³»åˆ—å•ç‰‡æœºå¯åˆ†ä¸ºARMCortex-M3å†…æ ¸ä½“ç³»ç»“æ„çš„ä¸åŒåº”ç”¨é¢†åŸŸã€‚å®ƒå¯åˆ†ä¸ºSTM32F1ç³»åˆ—å’ŒSTM32F4ç³»åˆ—ï¼ŒSTM32F1ç³»åˆ—å•ç‰‡æœºæ—¶é’Ÿé¢‘ç‡æœ€é«˜å¯è¾¾72MHZï¼Œåœ¨åŒä¸€äº§å“ä¸­æ€§èƒ½æœ€å¥½ã€‚å•ç‰‡æœºçš„åŸºæœ¬å¤„ç†é€Ÿåº¦ä¸º36ç±³ï¼Œ16ä½å•ç‰‡æœºçš„æ€§èƒ½ä¹Ÿå¾ˆå¥½ã€‚å¾®æ™¶ç‰‡çš„å†…å»ºå¿«é—ªè®°å¿†ä½“ç›¸å½“å¤§ï¼ŒèŒƒå›´ä»32kbåˆ°512kbï¼Œå¯è§†éœ€è¦é€‰æ‹©ã€‚å•ä¸ªè®¾å¤‡çš„åŠŸè€—éå¸¸ä½ï¼Œä»…360mAï¼Œ32ä½å•ç‰‡æœºäº§å“çš„åŠŸè€—æœ€ä½ï¼Œæ¯å…†èµ«åªæœ‰0.5å®‰åŸ¹ã€‚ç‰¹åˆ«å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå†…æ¥å•æ™¶ç‰‡æ±‡æµæ’æ˜¯ä¸€ç§Harvardæ¶æ„ï¼Œå¯æ‰§è¡Œé€Ÿåº¦é«˜è¾¾1.25 DMIPS/MHzçš„æŒ‡ä»¤ã€‚æ­¤èŠ¯ç‰‡è¶Šæ¥è¶Šå¤šåœ°è¢«ç”¨ä½œä¸»è¦æ§åˆ¶å™¨ã€‚<br>é€šè¿‡å¯¹å•ç‰‡æœºçš„èµ„æºå’Œå¤„ç†æ—¶é—´çš„é€Ÿåº¦æˆ‘ä»¬é‡‡ç”¨é€‰æ‹©STM32103C8T6ä¸ºæœ¬ç³»ç»Ÿä¸»æ§èŠ¯ç‰‡ï¼Œç¨‹åºä¸‹è½½æ˜¯åªéœ€è¦ä¸€ä¸ªJLINKå°±å¯ä»¥è½»æ¾å®Œæˆã€‚æ§åˆ¶å™¨æ¨¡å—ç”µè·¯å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/dpj.png" alt="å•ç‰‡æœºæœ€å°ç³»ç»Ÿ"></p><h2 id="ç”µæºæ¨¡å—è®¾è®¡"><a href="#ç”µæºæ¨¡å—è®¾è®¡" class="headerlink" title="ç”µæºæ¨¡å—è®¾è®¡"></a><center>ç”µæºæ¨¡å—è®¾è®¡</center></h2><p>æœ¬è®¾è®¡é‡‡ç”¨é”‚ç”µæ± ä¾›ç”µ, æ¨¡å—çš„ä¾›ç”µç”µå‹ä¸€èˆ¬éƒ½ä¸º5Vï¼ŒåŒæ—¶è¶…å£°æ³¢æ¨¡å—éœ€è¦è¾ƒå¤§çš„ç”µæµæ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œæ‰€ä»¥åœ¨é™å‹çš„åŸºç¡€ä¸Šä¹Ÿè¦ä¿è¯è¶³å¤Ÿå¤§çš„è¾“å‡ºç”µæµã€‚æœ¬è®¾è®¡é‡‡ç”¨å¯è°ƒè¾“å‡ºç‰ˆæœ¬ï¼Œæ¨¡å—çš„è¾“å…¥ç”µå‹èŒƒå›´å¹¿ï¼Œè¾“å‡ºç”µå‹åœ¨1.25V-35Vå†…å¯è°ƒï¼Œç”µå‹è½¬æ¢æ•ˆç‡é«˜ï¼Œè¾“å‡ºçº¹æ³¢å°ã€‚é™å‹ç”µè·¯å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/dy.png" alt="ç”µæºç®¡ç†ç”µè·¯"></p><h2 id="ç”µæœºé©±åŠ¨æ¨¡å—è®¾è®¡"><a href="#ç”µæœºé©±åŠ¨æ¨¡å—è®¾è®¡" class="headerlink" title="ç”µæœºé©±åŠ¨æ¨¡å—è®¾è®¡"></a><center>ç”µæœºé©±åŠ¨æ¨¡å—è®¾è®¡</center></h2><p>è¦å®Œæˆè½¬å‘æ˜¯èƒ½å¤Ÿåˆ©ç”¨å•ç‰‡æœºå®ç°çš„ï¼Œç„¶è€Œå•ç‰‡æœºI0çš„å¸¦è´Ÿè½½èƒ½åŠ›å¼±ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©äº†å¤§åŠŸç‡æ”¾å¤§å™¨ä»¶TB6612FNGã€‚TB6612FNGæ˜¯é‡‡ç”¨MOSFET-Hæ¡¥ç»“æ„çš„åŒé€šé“å¤§ç”µæµç”µè·¯è¾“å‡ºï¼Œå¯ä»¥æ§åˆ¶2ä¸ªç”µæœºçš„é©±åŠ¨ã€‚ç›¸æ¯”æ™®é€šçš„ç”µæœºé©±åŠ¨ï¼Œå¤–å›´ç”µè·¯éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ªèŠ¯ç‰‡å’Œä¸€ä¸ªé’½ç”µå®¹è¿›è¡ŒPWMè¾“å‡ºæ»¤æ³¢ï¼Œç³»ç»Ÿå°ºå¯¸å°ã€‚PWMä¿¡å·è¾“å…¥é¢‘ç‡èŒƒå›´å¹¿ï¼Œè½»æ¾æ»¡è¶³æœ¬è®¾è®¡çš„éœ€æ±‚ã€‚<br><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/qd.png" alt="ç”µæºé©±åŠ¨èŠ¯ç‰‡"></p><h3 id="ç”µæºé©±åŠ¨å¼•è„šè¡¨"><a href="#ç”µæºé©±åŠ¨å¼•è„šè¡¨" class="headerlink" title="ç”µæºé©±åŠ¨å¼•è„šè¡¨"></a>ç”µæºé©±åŠ¨å¼•è„šè¡¨</h3><pre><code>æ§åˆ¶èŠ¯ç‰‡:TB6612
æ§åˆ¶èŠ¯ç‰‡æ•°é‡:2
    1å·TB6612å¼•è„šåˆ†é…ï¼š
     VM         PWMA---------&gt;TIM1_CH1(PA8)
     VCC        AIN2---------&gt;GPIOB_12
     GND        AIN1---------&gt;GPIOB_13
     AO1        STBY---------&gt;GPIOB_14
     AO2        BIN1---------&gt;GPIOB_15
     BO2        BIN2---------&gt;GPIOA_12
     BO1        PWMB---------&gt;TIM1_CH2(PA9)
     GND        GND
    2å·TB6612å¼•è„šåˆ†é…ï¼š
     VM         PWMA---------&gt;TIM1_CH3(PA10)
     VCC        AIN2---------&gt;GPIOB_5
     GND        AIN1---------&gt;GPIOB_6
     AO1        STBY---------&gt;GPIOB_7
     AO2        BIN1---------&gt;GPIOB_8
     BO2        BIN2---------&gt;GPIOA_9
     BO1        PWMB---------&gt;TIM1_CH4(PA11)
     GND        GND
çœŸå€¼è¡¨
     AIN1   0     1     0     1
     AIN2   0     0     1     1
     BIN1   0     1     0     1
     BIN2   0     0     1     1
           åœæ­¢  æ­£è½¬  åè½¬  åˆ¹è½¦</code></pre><h3 id="ç”µæœºæ‰€ç”¨åˆ°çš„å®šæ—¶å™¨é…ç½®"><a href="#ç”µæœºæ‰€ç”¨åˆ°çš„å®šæ—¶å™¨é…ç½®" class="headerlink" title="ç”µæœºæ‰€ç”¨åˆ°çš„å®šæ—¶å™¨é…ç½®"></a>ç”µæœºæ‰€ç”¨åˆ°çš„å®šæ—¶å™¨é…ç½®</h3><pre><code>//åˆå§‹åŒ–TIMX,è®¾ç½®TIMxçš„ARR,PSC
//arrï¼šè‡ªåŠ¨é‡è£…è½½åˆå€¼ï¼Œpscä¸ºé¢„åˆ†é¢‘å€¼ï¼Œä¸¤è€…é…åˆæ§åˆ¶å®šæ—¶å™¨æ—¶é’Ÿçš„å‘¨æœŸ
//å®šæ—¶å™¨é€‰æ‹©TIM1
static void TB6612_ADVANCE_TIM1_Mode_Config(TIM_TypeDef* TIMx,uint16_t arr,uint16_t psc,uint16_t duty)
 {
     //-----------------æ—¶åŸºç»“æ„ä½“åˆå§‹åŒ–-------------------------/
     TIM_TimeBaseInitTypeDef TIM_TimeStructure;
     /*å¼€å¯å®šæ—¶å™¨1æ—¶é’Ÿï¼Œå³å†…éƒ¨æ—¶é’ŸCK_INT=72M*/
     RCC_APB2PeriphClockCmd(RCC_APB2Periph_TIM1,ENABLE);
    TIM_DeInit(TIMx);
    /*å†…éƒ¨æ—¶é’Ÿä½œä¸ºè®¡æ•°å™¨æ—¶é’Ÿï¼Œ72MHZ*/
    TIM_InternalClockConfig(TIMx);
    /*è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨çš„å€¼ï¼Œç´¯è®¡TIM_Period+1ä¸ªé¢‘ç‡åäº§ç”Ÿä¸€ä¸ªæ›´æ–°æˆ–è€…ä¸­æ–­*/
    TIM_TimeStructure.TIM_Period=arr;
    /*æ—¶é’Ÿé¢„åˆ†é¢‘ç³»æ•°ä¸º71ï¼Œåˆ™é©±åŠ¨è®¡æ•°å™¨çš„æ—¶é’ŸCK_CNT=CK_INT/(71+1)=1MHZ*/
    TIM_TimeStructure.TIM_Prescaler=psc-1;
    /*è®¾ç½®æ—¶é’Ÿåˆ†å‰²ï¼ŒTIM_CKD_DIV1=0ï¼ŒPWMæ³¢ä¸å»¶æ—¶*/
    TIM_TimeStructure.TIM_ClockDivision=TIM_CKD_DIV1;
    /*å‘ä¸Šè®¡æ•°æ¨¡å¼*/
    TIM_TimeStructure.TIM_CounterMode=TIM_CounterMode_Up;
    /*é‡å¤è®¡æ•°å™¨*/
    TIM_TimeStructure.TIM_RepetitionCounter=0;
    /*åˆå§‹åŒ–å®šæ—¶å™¨*/
    TIM_TimeBaseInit(TIMx,&amp;TIM_TimeStructure);
    /*ä½¿èƒ½ARRé¢„è£…è½½å¯„å­˜å™¨(å½±å­å¯„å­˜å™¨)*/
    TIM_ARRPreloadConfig(TIMx,ENABLE);
    //-----------------è¾“å‡ºæ¯”è¾ƒç»“æ„ä½“åˆå§‹åŒ–-----------------------/
    TIM_OCInitTypeDef   TIM_OCInitStructure;
    /*PWMæ¨¡å¼è®¾ç½®ï¼Œè®¾ç½®ä¸ºPWMæ¨¡å¼1*/
    TIM_OCInitStructure.TIM_OCMode=TIM_OCMode_PWM1;
    /*PWMè¾“å‡ºä½¿èƒ½ç›¸åº”çš„IOå£è¾“å‡ºä¿¡å·*/
    TIM_OCInitStructure.TIM_OutputState=TIM_OutputState_Enable;
    /*è®¾ç½®å ç©ºæ¯”å¤§å°,CCR1[15:0]: æ•è·/æ¯”è¾ƒé€šé“1çš„å€¼,è‹¥CC1é€šé“é…ç½®ä¸ºè¾“å‡ºï¼šCCR1åŒ…å«äº†è£…å…¥å½“å‰æ•è·/æ¯”è¾ƒ1å¯„å­˜å™¨çš„å€¼(é¢„è£…è½½å€¼)ã€‚*/
    TIM_OCInitStructure.TIM_Pulse=duty;
    /*è¾“å‡ºé€šé“ç”µå¹³ææ€§è®¾ç½®*/
    TIM_OCInitStructure.TIM_OCPolarity=TIM_OCPolarity_High;
    /*åˆå§‹åŒ–è¾“å‡ºæ¯”è¾ƒå‚æ•°*/
    TIM_OC1Init(TIMx,&amp;TIM_OCInitStructure);//åˆå§‹åŒ–TIM1 é€šé“1
    TIM_OC2Init(TIMx,&amp;TIM_OCInitStructure);//åˆå§‹åŒ–TIM1 é€šé“2
    TIM_OC3Init(TIMx,&amp;TIM_OCInitStructure);//åˆå§‹åŒ–TIM1 é€šé“3
    TIM_OC4Init(TIMx,&amp;TIM_OCInitStructure);//åˆå§‹åŒ–TIM1 é€šé“4
    /*è‡ªåŠ¨é‡è£…è½½*/
    TIM_OC1PreloadConfig(TIMx,TIM_OCPreload_Enable);
    TIM_OC2PreloadConfig(TIMx,TIM_OCPreload_Enable);
    TIM_OC3PreloadConfig(TIMx,TIM_OCPreload_Enable);
    TIM_OC4PreloadConfig(TIMx,TIM_OCPreload_Enable);
    /*ä½¿èƒ½è®¡æ•°å™¨*/
    TIM_Cmd(TIMx,ENABLE);
    /*ä¸»è¾“å‡ºä½¿èƒ½,å¦‚æœè®¾ç½®äº†ç›¸åº”çš„ä½¿èƒ½ä½(TIMx_CCERå¯„å­˜å™¨çš„CCxEã€CCxNEä½)ï¼Œåˆ™å¼€å¯OCå’ŒOCNè¾“å‡ºã€‚*/
    TIM_CtrlPWMOutputs(TIMx,ENABLE);    
}
//é«˜çº§å®šæ—¶å™¨è¾“å‡ºé€šé“åˆå§‹åŒ–å‡½æ•°
static void TB6612_ADVANCE_TIM_Gpio_Config()
{
    GPIO_InitTypeDef  GPIO_InitStruct;
    /*----------é€šé“1é…ç½®--------------*/
    /*å®šæ—¶å™¨1è¾“å‡ºæ¯”è¾ƒé€šé“*/
    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);
    /*é…ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º*/
    GPIO_InitStruct.GPIO_Mode=GPIO_Mode_AF_PP;
    GPIO_InitStruct.GPIO_Pin=GPIO_Pin_8;
    GPIO_InitStruct.GPIO_Speed=GPIO_Speed_50MHz;
    GPIO_Init(GPIOA,&amp;GPIO_InitStruct);
    /*-----------é€šé“äºŒé…ç½®-------------*/
    /*å®šæ—¶å™¨1è¾“å‡ºæ¯”è¾ƒé€šé“*/
    /*é…ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º*/
    GPIO_InitStruct.GPIO_Mode=GPIO_Mode_AF_PP;
    GPIO_InitStruct.GPIO_Pin=GPIO_Pin_11;
    GPIO_InitStruct.GPIO_Speed=GPIO_Speed_50MHz;
    GPIO_Init(GPIOA,&amp;GPIO_InitStruct);
     /*-----------é€šé“ä¸‰é…ç½®-------------*/
    /*å®šæ—¶å™¨1è¾“å‡ºæ¯”è¾ƒé€šé“*/
    /*é…ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º*/
    GPIO_InitStruct.GPIO_Mode=GPIO_Mode_AF_PP;
    GPIO_InitStruct.GPIO_Pin=GPIO_Pin_9;
    GPIO_InitStruct.GPIO_Speed=GPIO_Speed_50MHz;
    GPIO_Init(GPIOA,&amp;GPIO_InitStruct);
     /*-----------é€šé“å››é…ç½®-------------*/
    /*å®šæ—¶å™¨1è¾“å‡ºæ¯”è¾ƒé€šé“*/
    /*é…ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º*/
    GPIO_InitStruct.GPIO_Mode=GPIO_Mode_AF_PP;
    GPIO_InitStruct.GPIO_Pin=GPIO_Pin_10;
    GPIO_InitStruct.GPIO_Speed=GPIO_Speed_50MHz;
    GPIO_Init(GPIOA,&amp;GPIO_InitStruct);
}</code></pre><h2 id="è¶…å£°æ³¢æ¨¡å—"><a href="#è¶…å£°æ³¢æ¨¡å—" class="headerlink" title="è¶…å£°æ³¢æ¨¡å—"></a><center>è¶…å£°æ³¢æ¨¡å—</center></h2><p>é‡‡ç”¨HC-SR04è¶…å£°æ³¢æ¨¡å—ï¼Œè¯¥èŠ¯ç‰‡å…·æœ‰è¾ƒé«˜çš„é›†æˆåº¦ä»¥åŠè‰¯å¥½çš„ç¨³å®šæ€§ï¼Œæµ‹åº¦è·ç¦»ååˆ†ç²¾ç¡®ï¼Œååˆ†ç¨³å®šã€‚ä¾›ç”µç”µå‹ä¸ºDC5Vä¾›ç”µç”µæµå°äº10mAï¼Œæ¢æµ‹è·ç¦»ä¸º0.010m-3.5mä¸€å…±æœ‰å››ä¸ªå¼•è„šVCC(DC5V)ã€Trigerï¼ˆå‘å°„ç«¯ï¼‰ã€Echoï¼ˆæ¥æ”¶ç«¯ï¼‰ã€GNDï¼ˆåœ°ï¼‰ã€‚HC-SR04å®ç‰©å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/csb.png" alt="è¶…å£°æ³¢å®ç‰©"></p><p>è¯¥æ¨¡å—æ˜¯åˆ©ç”¨å•ç‰‡æœºçš„IOè§¦å‘ç”µå¹³æµ‹è·ï¼Œå•ç‰‡æœºå†…éƒ¨åˆ©ç”¨æ™®é€šå®šæ—¶å™¨äº§ç”Ÿä¸€ä¸ªé«˜ç”µå¹³ä¿¡å·ä¹‹åï¼Œè¶…å£°æ³¢å°±å¯ä»¥è‡ªä¸»å‘é€é¢‘ç‡ä¸º40khzçš„æ–¹æ³¢ï¼Œç„¶åç­‰å¾…ä¿¡å·çš„è¿”å›ï¼›è‹¥æœ‰ä¿¡å·è¿”å›ï¼Œå•ç‰‡æœºIOå£å°±ç«‹åˆ»è¾“å‡ºä¸€é«˜ç”µå¹³ï¼Œåˆ©ç”¨é«˜ç”µå¹³äº§ç”Ÿçš„æ—¶é—´å¯ä»¥è®¡ç®—å°è½¦ä¸éšœç¢ç‰©çš„è·ç¦»ã€‚æœ€ç»ˆè·ç¦»å°±æ˜¯é«˜ç”µå¹³æŒç»­æ—¶é—´ä¹˜ä»¥å£°éŸ³åœ¨ç©ºæ°”ä¸­ä¼ æ’­çš„é€Ÿåº¦å†é™¤ä»¥2ï¼Œå¯ä»¥åå¤æµ‹é‡è·ç¦»ã€‚<br>åœ¨ç¨‹åºå¼€å§‹é¦–å…ˆåˆå§‹åŒ–è¶…å£°æ³¢ï¼Œåˆ©ç”¨å®šæ—¶å™¨å¹¶è®¾ç½®æ—¶åŸºçš„è‡ªåŠ¨é‡è£…è½½åˆå€¼1000ï¼Œpscä¸ºé¢„åˆ†é¢‘å€¼72ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬äº§ç”Ÿä¸€æ¬¡ä¸­æ–­çš„æ—¶é—´æ˜¯1msï¼Œå¹¶è®¾ç½®æŠ¢å ä¼˜å…ˆçº§0ï¼Œå­ä¼˜å…ˆçº§3ã€‚HC_SR04_Echoå¼•è„šæ¥æ”¶åˆ°é«˜ç”µå¹³ï¼Œæ‰“å¼€å®šæ—¶å™¨ï¼Œä¸”æ¯1msè¿›å…¥ä¸€æ¬¡ä¸­æ–­ã€‚åœ¨æµ‹é‡æ—¶é¦–å…ˆè®©Trigå‘é€ä¸€ä¸ªå¤§äº10usçš„é«˜ç”µå¹³ï¼Œç„¶åæ‹‰é«˜HC_SR04_Trigï¼Œå½“Echoä¸º0æ—¶æ‰“å¼€å®šæ—¶å™¨è®¡æ—¶ï¼Œå½“Echoä¸º1æ—¶å…³é—­å®šæ—¶å™¨ï¼Œé€šè¿‡å…¬å¼è®¡ç®—è·ç¦»ã€‚<br>æ¨¡å—å·¥ä½œåŸç†ï¼š<br>(1)å•ç‰‡æœºè§¦å‘å¼•è„šï¼Œè¾“å‡ºé«˜ç”µå¹³ä¿¡å·ï¼›<br>(2)æ¨¡å—å‘é€ç«¯è‡ªåŠ¨å‘é€ç‰¹å®šé¢‘ç‡çš„æ–¹æ³¢ï¼›<br>(3)å¦‚æœæœ‰ä¿¡å·è¿”å›ï¼Œé€šè¿‡IOè¾“å‡ºä¸€é«˜ç”µå¹³ï¼Œé«˜ç”µå¹³æŒç»­çš„æ—¶é—´å°±æ˜¯è¶…å£°æ³¢çš„å‘å°„æ—¶é•¿ï¼›<br>(4)æµ‹è¯•è·ç¦»=(é«˜ç”µå¹³æ—¶é—´*å£°é€Ÿ(340M/S))/2ã€‚<br>æ³¨æ„ï¼šåœ¨ç¡¬ä»¶æ“ä½œä¸Šéœ€è¦é¦–å…ˆè®©æ¨¡å—åœ°ç«¯å…ˆè¿æ¥ï¼Œå¦åˆ™ä¼šå½±å“æ¨¡å—å·¥ä½œã€‚æµ‹è·æ—¶ï¼Œè¢«æµ‹ç‰©ä½“çš„æ‘†æ”¾ä¸èƒ½å¤ªè¿‡äºæ‚ä¹±ï¼Œå¦åˆ™ä¼šå½±å“æµ‹è¯•ç»“æœã€‚<br><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/csbjj.png" alt=""></p><h3 id="è¶…å£°æ³¢é‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰"><a href="#è¶…å£°æ³¢é‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰" class="headerlink" title="è¶…å£°æ³¢é‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰"></a>è¶…å£°æ³¢é‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰</h3><pre><code>/* è·å–æ¥æ”¶åˆ°çš„é«˜ç”µå¹³çš„æ—¶é—´ï¼ˆus*/
 uint32_t Get_HC_SR04_Time(void)
 {
     uint32_t t=0;
     t=Acoustic_Distance_Count*1000;//us
     t+=TIM_GetCounter(TIM2);//è·å–us
     TIM2-&gt;CNT =0;
     Acoustic_Distance_Count=0;
     Systic_Delay_us(100);
    return t;
}
/*è·å–è·ç¦»*/
void Get_HC_SR04_Distance(void)
{
    static uint16_t count=0;
    switch(count)
    {
        case 1:
        {
            GPIO_SetBits(Acoustic_Port,HC_SR04_Trig);//Trigå‘é€ä¸€ä¸ªå¤§äº10usçš„é«˜ç”µå¹³
        }break;

        case 15:
        {
            count=0;
            GPIO_ResetBits(Acoustic_Port,HC_SR04_Trig);
            while(GPIO_ReadInputDataBit(Acoustic_Port,HC_SR04_Echo)==0);//å½“Echoä¸º0æ—¶æ‰“å¼€å®šæ—¶å™¨ è®¡æ—¶
            Open_Tim2();
            while(GPIO_ReadInputDataBit(Acoustic_Port,HC_SR04_Echo)==1);//å½“Echoä¸º0æ—¶æ‰“å¼€å®šæ—¶å™¨ è®¡æ—¶
            Close_Tim2();
            HC_SR04_Distance=(float)(Get_HC_SR04_Time()/5.78);

        }break;
        default:break;
    }
    count++;
}</code></pre><h2 id="èˆµæœºæ¨¡å—"><a href="#èˆµæœºæ¨¡å—" class="headerlink" title="èˆµæœºæ¨¡å—"></a><center>èˆµæœºæ¨¡å—</center></h2><p>æœ¬ç³»ç»Ÿä½¿ç”¨çš„æ˜¯SG90å‹å·çš„èˆµæœºï¼Œèˆµæœºæ˜¯ä¸€ç§å¸¸è§çš„è§’åº¦é©±åŠ¨å™¨ï¼Œæœ¬ç³»ç»Ÿéœ€è¦åˆ¤æ–­ä¸åŒä½ç½®çš„éšœç¢ç‰©å¯ä»¥ä¸”å¯¹è½¬å‘çš„åŠ›åº¦å°ã€‚èˆµæœºå¯ä»¥ç†è§£ä¸ºæ–¹å‘ç›˜ç§°ï¼Œæ–¹å‘ç›˜æ˜¯ä¸€ä¸ªå¸¸è§çš„åå­—ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªä¼ºæœé©¬è¾¾ã€‚èˆµæœºå®ç‰©å›¾å¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/dj.png" alt=""></p><p>èˆµæœºæ¨¡å—æ¥å£ç®€å•ï¼Œèˆµæœºæ¨¡å—åªæœ‰ä¸‰ä¸ªå¼•è„šã€‚åˆ†åˆ«å¼•å¼•å‡ºäº†ä¸‰æ ¹çº¿å·¦å³ä¸¤è¾¹æ˜¯ç”µæºæ­£è´Ÿæ¥å£çº¿ï¼Œä¸­é—´ä¸€æ ¹æ˜¯PWMä¿¡å·çº¿ç›´æ¥è¿æ¥å•ç‰‡æœºçš„æ§åˆ¶å¼•è„šã€‚é€šè¿‡æ§åˆ¶å•ç‰‡æœºçš„å¼•è„šè¾“å‡ºçš„è„‰å†²å®½åº¦è¿›è€Œæ§åˆ¶èˆµæœºæ—‹è½¬çš„è§’åº¦ã€‚èˆµæœºæ¯å¢åŠ 0.1ms èˆµæœºå¯¹åº”å¢åŠ 9åº¦ã€‚<br>0.5msâ€”â€”â€”0<br>1.0msâ€”â€”â€”45<br>1.5msâ€”â€”â€”90<br>2.0msâ€”â€”â€”135<br>2.5msâ€”â€”â€”â€“180<br>20msçš„æ—¶åŸºè„‰å†²ï¼Œå¦‚æœæƒ³è®©èˆµæœºè½¬90åº¦ï¼Œå°±åº”è¯¥å‘ç”Ÿä¸€ä¸ªé«˜ç”µå¹³æŒç»­æ—¶é—´ä¸º1.5msï¼Œå‘¨æœŸä¸º20msçš„æ–¹æ³¢ï¼Œduty=1.5/20=7.5%ã€‚åœ¨è¿™é‡Œè®¾ç½®å®šæ—¶å™¨è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨arrçš„å€¼ä¸º1000ï¼Œæ‰€ä»¥å½“å ç©ºæ¯”ä¸ºç™¾åˆ†ä¹‹75æ˜¯ï¼Œåœ¨ç¨‹åºä¸­å°±è¦è®¾ç½®å ç©ºæ¯”ä¸º75/1000=7.5%ï¼Œ è¿™å°±æ˜¯å…·ä½“çš„ç®—æ³•ã€‚</p><h3 id="èˆµæœºé‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰"><a href="#èˆµæœºé‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰" class="headerlink" title="èˆµæœºé‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰"></a>èˆµæœºé‡è¦ä»£ç ï¼ˆå¯å‚è€ƒï¼‰</h3><pre><code>/**PWMå¼•è„šåˆå§‹åŒ–*/
 static void SERVO_Gpio_Init(void)
 {
     GPIO_InitTypeDef  GPIO_InitStruct;
     /*----------é€šé“2é…ç½®--------------*/
     /*å®šæ—¶å™¨3è¾“å‡ºæ¯”è¾ƒé€šé“*/
     RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA,ENABLE);
     /*é…ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡º*/
     GPIO_InitStruct.GPIO_Mode=GPIO_Mode_AF_PP;
    GPIO_InitStruct.GPIO_Pin=GPIO_Pin_7;
    GPIO_InitStruct.GPIO_Speed=GPIO_Speed_50MHz;
    GPIO_Init(GPIOA,&amp;GPIO_InitStruct); 
}
//å®šæ—¶å™¨3åˆå§‹åŒ–ï¼Œè®¾ç½®TIMxçš„ARR,PSC
//arrï¼šè‡ªåŠ¨é‡è£…è½½åˆå€¼ï¼Œpscä¸ºé¢„åˆ†é¢‘å€¼ï¼Œä¸¤è€…é…åˆæ§åˆ¶å®šæ—¶å™¨æ—¶é’Ÿçš„å‘¨æœŸ
static void SERVO_TIM_Config(TIM_TypeDef* TIMx,uint16_t arr,uint16_t psc,uint16_t duty)
{
    //-----------------æ—¶åŸºç»“æ„ä½“åˆå§‹åŒ–-------------------------/
    TIM_TimeBaseInitTypeDef TIM_TimeStructure;
    /*å¼€å¯å®šæ—¶å™¨3æ—¶é’Ÿï¼Œå³å†…éƒ¨æ—¶é’ŸCK_INT=72M*/
    RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM3,ENABLE);
    TIM_DeInit(TIMx);
    /*å†…éƒ¨æ—¶é’Ÿä½œä¸ºè®¡æ•°å™¨æ—¶é’Ÿï¼Œ72MHZ*/
    TIM_InternalClockConfig(TIMx);
    /*è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨çš„å€¼ï¼Œç´¯è®¡TIM_Period+1ä¸ªé¢‘ç‡åäº§ç”Ÿä¸€ä¸ªæ›´æ–°æˆ–è€…ä¸­æ–­*/
    TIM_TimeStructure.TIM_Period=arr;//1000 å½“å®šæ—¶å™¨ä»0è®¡æ•°åˆ°999ï¼Œå³1000æ¬¡ï¼Œä¸ºä¸€ä¸ªå®šæ—¶å‘¨æœŸ
    /*æ—¶é’Ÿé¢„åˆ†é¢‘ç³»æ•°ä¸º71ï¼Œåˆ™é©±åŠ¨è®¡æ•°å™¨çš„æ—¶é’ŸCK_CNT=CK_INT/(1440-1+1)=0.05MHZ*/
    TIM_TimeStructure.TIM_Prescaler=psc-1;;//1400  //å³å®šæ—¶å™¨çš„é¢‘ç‡ä¸º5KHZ   
    /*è®¾ç½®æ—¶é’Ÿåˆ†å‰²ï¼ŒTIM_CKD_DIV1=0ï¼ŒPWMæ³¢ä¸å»¶æ—¶*/
    TIM_TimeStructure.TIM_ClockDivision=TIM_CKD_DIV1;
    /*å‘ä¸Šè®¡æ•°æ¨¡å¼*/
    TIM_TimeStructure.TIM_CounterMode=TIM_CounterMode_Up;
    /*é‡å¤è®¡æ•°å™¨*/
    TIM_TimeStructure.TIM_RepetitionCounter=0;
        /*åˆå§‹åŒ–å®šæ—¶å™¨*/
    TIM_TimeBaseInit(TIMx,&amp;TIM_TimeStructure);
    /*ä½¿èƒ½ARRé¢„è£…è½½å¯„å­˜å™¨(å½±å­å¯„å­˜å™¨)*/
    TIM_ARRPreloadConfig(TIMx,ENABLE);
    //-----------------è¾“å‡ºæ¯”è¾ƒç»“æ„ä½“åˆå§‹åŒ– å¼€å§‹-----------------------/
    TIM_OCInitTypeDef   TIM_OCInitStructure;
    /*PWMæ¨¡å¼è®¾ç½®ï¼Œè®¾ç½®ä¸ºPWMæ¨¡å¼1*/
    TIM_OCInitStructure.TIM_OCMode=TIM_OCMode_PWM1;
    /*PWMè¾“å‡ºä½¿èƒ½ç›¸åº”çš„IOå£è¾“å‡ºä¿¡å·*/
    TIM_OCInitStructure.TIM_OutputState=TIM_OutputState_Enable;
    /*è®¾ç½®å ç©ºæ¯”å¤§å°,CCR1[15:0]: æ•è·/æ¯”è¾ƒé€šé“1çš„å€¼,è‹¥CC1é€šé“é…ç½®ä¸ºè¾“å‡ºï¼šCCR1åŒ…å«äº†è£…å…¥å½“å‰æ•è·/æ¯”è¾ƒ1å¯„å­˜å™¨çš„å€¼(é¢„è£…è½½å€¼)ã€‚*/
    TIM_OCInitStructure.TIM_Pulse=duty;   //å ç©ºæ¯”å¤§å°
    /*è¾“å‡ºé€šé“ç”µå¹³ææ€§è®¾ç½®*/
    TIM_OCInitStructure.TIM_OCPolarity=TIM_OCPolarity_High;
    /*åˆå§‹åŒ–è¾“å‡ºæ¯”è¾ƒå‚æ•°*/
    TIM_OC2Init(TIMx,&amp;TIM_OCInitStructure);
    //-----------------è¾“å‡ºæ¯”è¾ƒç»“æ„ä½“åˆå§‹åŒ– ç»“æŸ-----------------------/    
    /*è‡ªåŠ¨é‡è£…è½½*/
    TIM_OC2PreloadConfig(TIMx,TIM_OCPreload_Enable);
    /*ä½¿èƒ½è®¡æ•°å™¨*/
    TIM_Cmd(TIMx,ENABLE);
    /*ä¸»è¾“å‡ºä½¿èƒ½,å¦‚æœè®¾ç½®äº†ç›¸åº”çš„ä½¿èƒ½ä½(TIMx_CCERå¯„å­˜å™¨çš„CCxEã€CCxNEä½)ï¼Œåˆ™å¼€å¯OCå’ŒOCNè¾“å‡ºã€‚*/
    TIM_CtrlPWMOutputs(TIMx,ENABLE);    
}
/*èˆµæœºPWMåˆå§‹åŒ–
   æ¯å¢åŠ 0.1ms èˆµæœºå¯¹åº”å¢åŠ 9åº¦
0.5ms---------0
1.0ms---------45   
1.5ms---------90
2.0ms---------135
2.5ms-----------180
2.1ms    turn_left=150
0.8ms    turn_right=25
1.3ms    turn_front=75
20msçš„æ—¶åŸºè„‰å†²ï¼Œå¦‚æœæƒ³è®©èˆµæœºè½¬90åº¦ï¼Œå°±åº”è¯¥å‘ç”Ÿä¸€ä¸ªé«˜ç”µå¹³ä¸º1.5msï¼Œå‘¨æœŸä¸º20msçš„æ–¹æ³¢ï¼Œduty=1.5/20=7.5% ,è€Œå®šæ—¶å™¨è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨arrçš„å€¼ä¸º 1000 ï¼Œæ‰€ä»¥duty=75ï¼Œæ—¶å ç©ºæ¯”ä¸º75/1000=7.5%. 
*/
void SERVO_Init(void)
{
    SERVO_Gpio_Init();
    SERVO_TIM_Config(TIM3,1000,1440,turn_front);
/** æˆ‘ä»¬æŠŠå®šæ—¶å™¨è®¾ç½®è‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨ arr çš„å€¼ä¸º 1000ï¼Œè®¾ç½®æ—¶é’Ÿé¢„åˆ†é¢‘å™¨ä¸º 1440ï¼Œåˆ™
é©±åŠ¨è®¡æ•°å™¨çš„æ—¶é’Ÿï¼šCK_CNT = CK_INT / (1440-1+1)=0.05Mï¼Œåˆ™è®¡æ•°å™¨è®¡æ•°ä¸€æ¬¡çš„æ—¶é—´ç­‰äºï¼š
1/CK_CNT=20usï¼Œå½“è®¡æ•°å™¨è®¡æ•°åˆ° ARR çš„å€¼ 1000 æ—¶ï¼Œäº§ç”Ÿä¸€æ¬¡ä¸­æ–­ï¼Œåˆ™ä¸­æ–­ä¸€æ¬¡çš„æ—¶é—´
ä¸ºï¼š1/CK_CNT*ARR=20msã€‚
PWM ä¿¡å·çš„é¢‘ç‡ f = TIM_CLK/{(ARR+1)*(PSC+1)}  TIM_CLK=72MHZ
               = 72 000 000/(1000*1440)=5KHZ    
*/    
}
/*èˆµæœºè§’åº¦æ§åˆ¶*/
void SERVO_Angle_Control(uint16_t Compare2)
{
    TIM_SetCompare2(TIM3,Compare2);
}</code></pre><h2 id="ç¼–ç å™¨æ¨¡å—"><a href="#ç¼–ç å™¨æ¨¡å—" class="headerlink" title="ç¼–ç å™¨æ¨¡å—"></a><center>ç¼–ç å™¨æ¨¡å—</center></h2><p>è°ƒèŠ‚å°è½¦å‰è¿›çš„é€Ÿåº¦å’Œé¿éšœå¿«æ…¢æˆ‘ä»¬é‡‡ç”¨EC11æ—‹è½¬å¼ç¼–ç å™¨ï¼Œå¯ä»¥ç”¨äºå…‰åº¦ã€æ¹¿åº¦ã€éŸ³é‡è°ƒèŠ‚ç­‰å‚æ•°çš„è°ƒèŠ‚ã€‚EC11ç¼–ç å™¨çš„å½¢çŠ¶ç±»ä¼¼äºç”µä½å™¨ï¼Œä¸­å¿ƒæœ‰ä¸€ä¸ªæ—‹é’®å¯ä»¥è°ƒèŠ‚PWMä¿¡å·ï¼Œå…‰ç”µç ç›˜åˆ©ç”¨å…‰ç”µè½¬æ¢åŸç†è¾“å‡ºä¸‰ç»„æ–¹æ³¢è„‰å†²ã€‚EC11ç¼–ç å™¨çš„å®ç‰©å›¾å¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/loading3.gif" data-original="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/blog/bmq.png" alt=""></p><hr><p>ç”¨æ¥æ˜¾ç¤ºå°è½¦è½¬é€Ÿï¼Œä»¥åŠå·¦å³ç¼–ç å™¨æ•°å€¼å’Œç”µæ± ç”µå‹ç­‰å‚æ•°æ‰€ç”¨çš„æ˜¯OLEDæ˜¾ç¤ºæ¨¡å—ï¼Œåˆ†è¾¨ç‡è¾ƒé«˜ï¼Œè€Œä¸”åŠŸè€—ä½ï¼Œæ­£å¸¸æ˜¾ç¤ºæ—¶ä»…0.06Wï¼Œä¾›ç”µç”µå‹èŒƒå›´åœ¨3.3V-5Vï¼Œæœ‰IICå’ŒSPIä¸¤ç§é€šä¿¡åè®®å¯ä¾›é€‰æ‹©ã€‚æ˜¾ç¤ºæ¨¡å—çš„äº®åº¦å’Œå¯¹æ¯”åº¦å¯ä»¥é€šè¿‡ç¨‹åºè®¾ç½®ã€‚ç”±äºå®ƒä½¿ç”¨å¯¿å‘½é•¿ä»¥åŠå…¶ä»–çš„ä¼˜ç‚¹ï¼ŒOLEDæ›´åŠ é€‚åˆå°ç³»ç»Ÿï¼Œæœ¬ç³»ç»Ÿç”±äºå•ç‰‡æœºå¼•è„šæœ‰é™ï¼Œä¸é€‚åˆåˆ©ç”¨ç®€å•çš„LCD1602æˆ–è€…12864æ¥æ˜¾ç¤ºï¼Œåœ¨å¤šæ–¹å¯¹æ¯”ä¹‹ä¸‹OLEDæ•ˆæœæ›´å¥½ã€‚OLEDæ˜¾ç¤ºéƒ¨åˆ†ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå¤§å®¶å‚è€ƒä¸­æ™¯å›­çš„ä¾‹ç¨‹å°±å¯ä»¥å®ç°ã€‚</p><hr></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">æ–‡ç« ä½œè€…:</i></span> <span class="reprint-info"><a href="https://www.liuyao-blog.cn" rel="external nofollow noreferrer">å°å¸ˆå¼Ÿ</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">æ–‡ç« é“¾æ¥:</i></span> <span class="reprint-info"><a href="https://www.liuyao-blog.cn/posts/55359.html">https://www.liuyao-blog.cn/posts/55359.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">ç‰ˆæƒå£°æ˜:</i></span> <span class="reprint-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://www.liuyao-blog.cn" target="_blank">å°å¸ˆå¼Ÿ</a> !</span></div></div><script async defer>document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/STM32/"><span class="chip bg-color">STM32</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" href="/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯åˆ†äº«ï¼</p>"></div><script src="/libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">èµ</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">ä½ çš„èµè¯†æ˜¯æˆ‘å‰è¿›çš„åŠ¨åŠ›</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li></ul><div id="alipay"><img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç "></div><div id="wechat"><img src="/medias/reward/wechat.png" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç "></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/comment_bg.png) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>è¯„è®º</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="/libs/valine/av-min.js"></script><script src="/libs/valine/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"raCHkXsnO0FjwQtzobTDp9O9-gzGzoHsz",appKey:"QhNh299PArdBCy32jX6sT0cp",notify:!1,verify:!1,visitor:!0,avatar:"mm",pageSize:"10",lang:"zh-cn",placeholder:"just go go"})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i> &nbsp;ä¸Šä¸€ç¯‡</div><div class="card"><a href="/posts/d56b.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/cover4.jpg" class="responsive-img" alt="Githubå…¥é—¨"> <span class="card-title">Githubå…¥é—¨</span></div></a><div class="card-content article-content"><div class="summary block-with-text">ä¸¤ä¸ªå°æ—¶ææ‡‚Github</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2020-01-20</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/Github%E5%85%A5%E9%97%A8/" class="post-category">Githubå…¥é—¨</a></span></div></div><div class="card-action article-tags"><a href="/tags/Github%E5%85%A5%E9%97%A8/"><span class="chip bg-color">Githubå…¥é—¨</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">ä¸‹ä¸€ç¯‡&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/31346.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/cdn@1.2/cover/cover2.jpg" class="responsive-img" alt="å¸¸ç”¨è½¯ä»¶å·¥å…·æ¨è"> <span class="card-title">å¸¸ç”¨è½¯ä»¶å·¥å…·æ¨è</span></div></a><div class="card-content article-content"><div class="summary block-with-text">åˆ†äº«å®ç”¨ç½‘ç«™å’Œè£…æœºå¿…å¤‡è½¯ä»¶</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i> 2020-01-15</span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/" class="post-category">å®ç”¨å·¥å…·</a></span></div></div><div class="card-action article-tags"><a href="/tags/windows/"><span class="chip bg-color">windows</span></a> <a href="/tags/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/"><span class="chip bg-color">å®ç”¨å·¥å…·</span></a></div></div></div></div></article></div><script src="/libs/codeBlock/codeBlockFuction.js"></script><script src="/libs/codeBlock/codeCopy.js"></script><script src="/libs/codeBlock/codeShrink.js"></script><style>code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="/libs/tocbot/tocbot.min.js"></script><script>$(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* ä¿®å¤æ–‡ç« å¡ç‰‡ div çš„å®½åº¦. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // åˆ‡æ¢TOCç›®å½•å±•å¼€æ”¶ç¼©çš„ç›¸å…³æ“ä½œ.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });</script></main><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:15px!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020</span> <a href="https://www.liuyao-blog.cn" target="_blank">å°å¸ˆå¼Ÿ</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;<span class="white-color">46.6k</span>&nbsp;å­— <span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;æ€»è®¿é—®é‡:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;æ¬¡</span> <span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;æ€»è®¿é—®äººæ•°:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;äºº</span><br><span id="sitetime">è½½å…¥è¿è¡Œæ—¶é—´...</span><script>function siteTime(){var e=36e5,t=24*e,n=new Date,o="2020",r=n.getFullYear(),a=n.getMonth()+1,i=n.getDate(),l=n.getHours(),m=n.getMinutes(),M=n.getSeconds(),g=Date.UTC(o,"1","12","0","0","0"),d=Date.UTC(r,a,i,l,m,M)-g,s=Math.floor(d/31536e6),u=Math.floor(d/t-365*s),T=Math.floor((d-(365*s+u)*t)/e),c=Math.floor((d-(365*s+u)*t-T*e)/6e4),f=Math.floor((d-(365*s+u)*t-T*e-6e4*c)/1e3);o==r?(document.getElementById("year").innerHTML=r,document.getElementById("sitetime").innerHTML="æœ¬ç«™å·²å®‰å…¨è¿è¡Œ "+u+" å¤© "+T+" å°æ—¶ "+c+" åˆ†é’Ÿ "+f+" ç§’"):(document.getElementById("year").innerHTML=o+" - "+r,document.getElementById("sitetime").innerHTML="æœ¬ç«™å·²å®‰å…¨è¿è¡Œ "+s+" å¹´ "+u+" å¤© "+T+" å°æ—¶ "+c+" åˆ†é’Ÿ "+f+" ç§’")}setInterval(siteTime,1e3)</script><br><span id="icp"><img src="/medias/icp.png" style="vertical-align:text-bottom"> <a href="http://www.beian.miit.gov.cn/" target="_blank">é„‚ICPå¤‡20001730å·</a></span></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/xiaoshidi-hub" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i></a><a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2515361695" class="tooltipped" target="_blank" data-tooltip="QQè”ç³»æˆ‘: 2515361695" data-position="top" data-delay="50"><i class="fab fa-qq"></i></a><a href="https://cdn.jsdelivr.net/gh/xiaoshidi-hub/PicGO/picture/%E5%BE%AE%E4%BF%A1.png" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„å¾®ä¿¡" data-position="top" data-delay="50"><i class="fab fa-weixin"></i></a><a href="https://space.bilibili.com/357524621" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„Bç«™" data-position="top" data-delay="50"><i class="fas fa-bold"></i></a> <a href="https://blog.csdn.net/qq_39400113" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„csdn" data-position="top" data-delay="50"><i class="fas fa-csdn">C</i></a> <a href="https://www.zhihu.com/people/guo-guo-xiao-shi-di/activities" class="tooltipped" target="_blank" data-tooltip="å…³æ³¨æˆ‘çš„çŸ¥ä¹: https://www.zhihu.com/people/guo-guo-xiao-shi-di/activities" data-position="top" data-delay="50"><i class="fab fa-zhihu1">çŸ¥</i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i> &nbsp;&nbsp;æœç´¢</span> <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—" class="search-input"></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><script>$(function(){searchFunc("/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="/libs/materialize/materialize.min.js"></script><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/aos/aos.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script><script src="/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="/js/matery.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/libs/others/clicklove.js" async></script><script async src="/libs/others/busuanzi.pure.mini.js"></script><script src="/libs/background/ribbon-dynamic.js" async></script><script src="/libs/instantpage/instantpage.js" type="module"></script><script src="/js/click_show_text.js"></script><script>var st,OriginTitile=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="çœ‹ä¸è§æˆ‘ğŸ™ˆ~çœ‹ä¸è§æˆ‘ğŸ™ˆ~",clearTimeout(st)):(document.title="(à¹‘â€¢Ì€ã…‚â€¢Ì) âœ§è¢«å‘ç°äº†ï½",st=setTimeout(function(){document.title=OriginTitile},3e3))})</script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js?t=1583038739475").then(function(){console.log("ServiceWorker Register Successfully.")}).catch(function(e){console.error(e)})</script><script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)0<=(t=c[r].getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n()},e.src=i}();var t}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this)</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script></body></html>